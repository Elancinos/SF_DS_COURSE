# <center> Project-6. Сегментирование клиентов онлайн-магазина подарков
---

## <center> <a id="table_of_content">Оглавление</a>
[1. Описание проекта и постановка задачи](#descripton)  
[2. Знакомство с данными](#data_reading)  
[3. Предобработка и очистка данных](#data_preparation)  
[4. Разведывательный анализ данных](#EDA)  
[5. RFM-сегментация клиентов, часть 1](#RFM_1)  
[6. RFM-сегментация клиентов, часть 2](#RFM_2)  
[7. RFM-сегментация клиентов, часть 3](#RFM_3)  
[8. Выводы](#final)  

---

### <center> <a id="description">Описание проекта и постановка задачи</a>

В данном проекте решается задача в области маркетинга. Нам предстоит произвести сегментацию клиентов на основе их покупательской способности, частоты совершения заказов и срока давности последнего заказа, а также определить оптимальную стратегию взаимодействия с ними.

Маркетинг — неотъемлемая часть любого бизнеса. Для повышения прибыли компании важно понимать своего клиента, его пожелания и предпочтения. С появлением электронной коммерции, или онлайн-продаж, стало намного проще собирать данные о клиентах, анализировать их, находить закономерности и реализовывать маркетинговые кампании.

Большинство интернет-магазинов используют инструменты веб-аналитики, чтобы отслеживать просмотры страниц, количество и поведение посетителей и коэффициент отказов. Но отчёта из Google Analytics или аналогичной системы может быть недостаточно для полного понимания того, как клиенты взаимодействуют с сайтом. Компаниям важно иметь возможность быстро и точно реагировать на перемены в поведении клиентов, создавая инструменты, которые обнаруживают эти изменения практически в режиме реального времени.

Машинное обучение помогает поисковой системе анализировать огромное количество данных о посетителях платформы, узнавать модели поведения профессиональных покупателей, определять категорию клиентов (например, лояльные/перспективные/новички/спящие/ушедшие) и выбирать правильную стратегию взаимодействия с ними.

Стоит также отметить, что компании, использующие машинное обучение на своих платформах электронной коммерции, могут постоянно повышать эффективность бизнес-процессов: настраивать товарную выборку персонально для каждого покупателя и предлагать выгодную цену в соответствии с бюджетом клиента и т. д. Эта задача относится к категории построения рекомендательных систем, речь о которых пойдёт в следующем разделе нашего курса.

Как правило, наборы данных для электронной коммерции являются частной собственностью и, следовательно, их трудно найти среди общедоступных данных. 

**Бизнес-задача:** произвести сегментацию существующих клиентов, проинтерпретировать эти сегменты и определить стратегию взаимодействия с ними.

**Техническая задача как для специалиста в Data Science:** построить модель кластеризации клиентов на основе их покупательской способности, частоты заказов и срока давности последней покупки, определить профиль каждого из кластеров.

**Основные цели проекта:**
1. Произвести предобработку набора данных.
2. Провести разведывательный анализ данных и выявить основные закономерности.
3. Сформировать категории товаров и клиентов. 
4. Построить несколько моделей машинного обучения, решающих задачу кластеризации клиентов, определить количество кластеров и проинтерпретировать их.
5. Спроектировать процесс предсказания категории интересов клиента и протестировать вашу модель на новых клиентах.

### Проект состоит из следующих частей:
1. Первичная обработка данных.  
2. Разведывательный анализ данных (EDA).  
3. Отбор и преобразование признаков.  
4. Решение задачи регрессии: линейная регрессия и деревья решений.  
5. Решение задачи регрессии: ансамбли моделей и построение прогноза.  

Подробнее о каждом этапе в можно узнать в соответствующих пунктах, тыкнув на интересующий в оглавлении, или просто промотав.

#### :exclamation: ***Пару слов о процессе выполнения***
В процессе выполения работы старался комментировать интересные места и особенности, а также проводить дополнительные исследования при необходимости, отходя от заданий, где считал это необходимым. Всё для более качественного выполнения общего задания каждой части работы.
Работа изначально делалась как практическая для платформы с фиксированными ответами, отсюда некоторые части кода могут показаться нелогичными или нерациональными. Я бы и сам сделал их по-другому, но старался не отходить от задуманного решения, так как это могло бы вызвать проблемы с прогрессом на этой самой платформе. Также стоит отметить, что некоторый код может выглядеть необычно, так как сделан на старых версиях библиотек, для сходимости с платформой.

Версии и информацию об использованных в работе библиотеках можно найти в файле "pyproject.toml", полный набор пакетов - в файле "poetry.lock". Соответсвенно, в качестве менеджера версий использовался poetry.

:floppy_disk: Исходные файлы датасетов из работы для удобства сохранил по ссылке:
https://drive.google.com/file/d/156T_ArLWL6GTcNLcOkNvmr_RDTaD0cU9/view?usp=drive_link

:exclamation: В процессе выполнения кода после очистки данных формируется очищенный дата-сет с сохранением на компьютере.

:floppy_disk: Также в репозитории в папке "graphs" можно найти получившиеся графики библиотеки plotly в формате html.

:arrow_up: [к оглавлению](#table_of_content) :arrow_up:

---

### <center> <a id="data_reading">Знакомство с данными</a>

На данном этапе мы предзагружаем библиотеки, читаем данные, их параметры, производим первичную обработку.

---

### <center> <a id="data_preparation">Предобработка и очистка данных</a>

На этом этапе происходит очистка данных от дубликатов, пропусков и ищем связанные с этим данные, например строки, сигнализирующие о возвратах. Их, к слову, сохранили на будущее в отдельный признак.

---

### <center> <a id="EDA">Разведывательный анализ данных</a>

На данном этапе подробно исследуются транзакции. Тут в основном исследуем следующие задачи:

* понять, клиенты из каких стран покупают больше и чаще;
* узнать, присутствует ли в продажах сезонность (когда покупают чаще);
* создать новые признаки, которые в дальнейшем понадобятся при формировании датасета о клиентах.

---

### <center> <a id="RFM_1">RFM-сегментация клиентов, часть 1</a>

На данном этапе анализируется потребительская ценность с помощью RMF-метода.  

Метод заключается в группировке клиентов на основе следующих параметров:
* Recency (Давность) — давность последней покупки клиента;
* Frequency (Частота) — общее количество покупок клиента;
* Monetary Value (Денежная ценность) — сколько денег потратил клиент.  
Суть RFM-анализа состоит в том, что мы разделяем всех клиентов на группы в зависимости от того, как давно они сделали последнюю покупку, как часто покупали и насколько большой была сумма их заказов.

Сначала формируем RFM-таблицу, смотрим, что получилось, а далее через пайплайны применяем PCA и получаем кластеры с помощью k-means и EM-алгоритма в качестве первоначальных моеделей. После этого ищем оптимальные количества кластеров с помощью коэффициента силуэта.

---

### <center> <a id="RFM_2">RFM-сегментация клиентов, часть 2</a>

На этом этапе мы также работаем с изначальной RFM-таблицей, полученной в начале части 1, но далее вместо PCA используем пайплайн с t-SNE и также ищем оптимальные количества кластеров для k-means, EM-алгоритма и агломеративной кластеризации, также с помощью коэффициента силуэта, обучаем модель с количеством кластеров, показавшим наибольший коэффициент.

---

### <center> <a id="RFM_3">RFM-сегментация клиентов, часть 3</a>

На этом этапе сводим нашу задачу из кластеризации в классификацию, для получения модели, которая предсказывала бы кластер для новых клиентов в будущем. Разделяем выборки, подбираем оптимальные гиперпараметры для моделей случайного леса и градиентного бустинга, и обучаем их.

---

### <center> <a id="final">Выводы</a>

По итогу имеем обработанный дата-сет, посмотрели, из чего состоят данные на этапе RDA, составили RFM-таблицу, по которой произвели понижение размерности данных, кластеризировали клиентов и получили 2 эффективные модели для предсказания кластера будущего клиента. 