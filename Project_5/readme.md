# <center> Project-5. Задача регрессии
---

## <center> <a id ="table_of_content">Оглавление</a>  
[1. Описание проекта](#description)  
[2. Первичная обработка данных](#data_preparation)  
[3. Разведывательный анализ данных (EDA)](#EDA)   
[4. Отбор и преобразование признаков](#feature_selection)   
[5. Решение задачи регрессии: линейная регрессия и деревья решений](#first_solution)   
[6. Решение задачи регрессии: ансамбли моделей и построение прогноза](#last_solution)  
[7. Выводы](#final)

---

### <center> <a id='description'> Описание проекта</a>

В данной работе нам предстоит решить задачу, направленную на автоматизацию бизнес=процесса по перевозке пассажиров, то есть предсказывать общую продолжительность поездки на такси в Нью-Йорке. Представьте, что вы заказываете такси из одной точки Нью-Йорка в другую, причём необязательно, что конечная точка должна находиться в пределах города. Сколько вы должны будете заплатить за поездку?

Известно, что стоимость такси в США рассчитывается на основе фиксированной ставки и тарифной стоимости, величина которой зависит от времени и расстояния. Тарифы варьируются в зависимости от города.

В свою очередь, время поездки зависит от множества факторов, таких как направление поездки, время суток, погодные условия и так далее.

Таким образом, если мы разработаем алгоритм, способный определять длительность поездки, мы сможем прогнозировать её стоимость самым тривиальным образом, например, просто умножая стоимость на заданный тариф.


#### ***Бизнес-задача:***
Определить характеристики и с их помощью спрогнозировать длительность поездки на такси.

#### ***Техническая задача:***
Построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать числовой признак — время поездки такси, то есть решить задачу регрессии.

#### ***Основные задачи:***
1. Сформировать набор данных на основе нескольких источников информации.
2. Спроектировать новые признаки с помощью Feature Engineering и выявить наиболее значимые при построении модели.
3. Исследовать предоставленные данные и выявить закономерности.
4. Построить несколько моделей и выбрать из них ту, которая показывает наилучший результат по заданной метрике.
5. Спроектировать процесс предсказания длительности поездки для новых данных.
6. Загрузить своё решение на платформу Kaggle, тем самым поучаствовав в настоящем Data Science-соревновании.

### Проект состоит из следующих частей:
1. Первичная обработка данных.

2. Разведывательный анализ данных (EDA).

3. Отбор и преобразование признаков.

4. Решение задачи регрессии: линейная регрессия и деревья решений. 

5. Решение задачи регрессии: ансамбли моделей и построение прогноза.

Подробнее о каждом этапе в можно узнать в соответствующих пунктах, тыкнув на интересующий в оглавлении, или просто промотав.

#### :exclamation: ***Пару слов о процессе выполнения***
В процессе выполения работы старался комментировать интересные места и особенности, а также проводить дополнительные исследования при необходимости, отходя от заданий, где считал это необходимым. Всё для более качественного выполнения общего задания каждой части работы.
Работа изначально делалась как практическая для платформы с фиксированными ответами, отсюда некоторые части кода могут показаться нелогичными или нерациональными. Я бы и сам сделал их по-другому, но старался не отходить от задуманного решения, так как это могло бы вызвать проблемы с прогрессом на этой самой платформе.

Версии и информацию об использованных в работе библиотеках можно найти в файле "pyproject.toml", полный набор пакетов - в файле "poetry.lock". Соответсвенно, в качестве менеджера версий использовался poetry.

:floppy_disk: Исходные файлы датасетов из работы для удобства сохранил по ссылкам (в общем они весят прилично, так как объём данных немаленький):
 - Основной датасет: https://drive.google.com/file/d/1X_EJEfERiXki0SKtbnCL9JDv49Go14lF/view?usp=sharing
 - Датасет с данными о праздниках: https://lms.skillfactory.ru/asset-v1:SkillFactory+DST-3.0+28FEB2021+type@asset+block@holiday_data.csv
 - Датасет с данными из API OSRM (Open Source Routing Machine): https://drive.google.com/file/d/1ecWjor7Tn3HP7LEAm5a0B_wrIfdcVGwR/view?usp=sharing
 - Датасет с данными о погоде за примерно предстваленный период в основном датасете: https://lms.skillfactory.ru/asset-v1:SkillFactory+DST-3.0+28FEB2021+type@asset+block@weather_data.zip
 - Вариация основного датасета с тестовыми данными: https://drive.google.com/file/d/1C2N2mfONpCVrH95xHJjMcueXvvh_-XYN/view?usp=sharing
 - Вариация данных из API OSRM для тестовых данных: https://drive.google.com/file/d/1wCoS-yOaKFhd1h7gZ84KL9UwpSvtDoIA/view?usp=sharing

:floppy_disk:

Также в репозитории в папке "graphs" можно найти получившиеся графики библиотеки plotly в формате html. !!! Некоторые графики из-за объемности данных весят довольно много, дабы GitHub не ругался, было принято решение их не включать. Но в коде остались строки, позволяющие их сохранить. Но для этого один прогон исходного кода. Либо свяжитесь со мной, у меня они в наличии.

:arrow_up: [к оглавлению](#table_of_content) :arrow_up:

---

### <center> <a id='data_preparation'> Первичная обработка данных </a>

В рамках этой части нам предстоит сформировать набор данных на основе предложенных нами источников информации, а также обработать пропуски и выбросы в данных.

:arrow_up: [к оглавлению](#table_of_content) :arrow_up:

---

### <center> <a id='EDA'> Разведывательный анализ данных (EDA) </a>

На этом этапе необходимо будет исследовать данные, нащупать первые закономерности и выдвинуть гипотезы.

:arrow_up: [к оглавлению](#table_of_content) :arrow_up:

---

### <center> <a id='feature_selection'> Отбор и преобразование признаков </a>

На этом этапе перекодируются и преобразуются данные таким образом, чтобы их можно было использовать при решении задачи регрессии — для построения модели.

:arrow_up: [к оглавлению](#table_of_content) :arrow_up:

---

### <center> <a id='first_solution'> Решение задачи регрессии: линейная регрессия и деревья решений </a>

На данном этапе строятся первые прогностические модели и оценивается их качество. Тем самым мы отвечаем на вопрос: «Решаема ли вообще представленная задача?»

:arrow_up: [к оглавлению](#table_of_content) :arrow_up:

---

### <center> <a id='last_solution'> Решение задачи регрессии: ансамбли моделей и построение прогноза </a>

На данном этапе строятся окончательные предсказания с помощью ансамблиевых моделей, таких как случайный лес, стохаистический градиентный бустинг и экстремальный градиентный бустинг.

:arrow_up: [к оглавлению](#table_of_content) :arrow_up:

---

### <center> <a id='final'> Итоги </a>

Задача выполнена, прогноз построен, а средняя ошибка в самых успешных моделях составляет 1.7-1.8 минуты. В целом, результат не самый лучший, при более глубоком анализе признаков и дополнительной оптимизации гиперпараметров модели, думаю, можно добиться лучших результатов. Пометочка на будущее.

:arrow_up: [к оглавлению](#table_of_content) :arrow_up: